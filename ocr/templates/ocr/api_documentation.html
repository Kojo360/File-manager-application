{% extends 'ocr/base.html' %}

{% block title %}API Documentation - File Manager{% endblock %}

{% block page_title %}API Documentation{% endblock %}
{% block page_subtitle %}RESTful API endpoints for programmatic access{% endblock %}

{% block content %}
<div class="api-docs-container">
  <!-- API Overview -->
  <div class="api-overview">
    <div class="overview-header">
      <h2>
        <i class="fas fa-code"></i>
        File Manager API v1.0
      </h2>
      <p>Comprehensive RESTful API for file management, OCR processing, and bulk operations</p>
    </div>
    
    <div class="api-stats">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-plug"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number">5</span>
          <span class="stat-label">API Endpoints</span>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number">REST</span>
          <span class="stat-label">Protocol</span>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-exchange-alt"></i>
        </div>
        <div class="stat-info">
          <span class="stat-number">JSON</span>
          <span class="stat-label">Response Format</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Start -->
  <div class="api-section">
    <h3>
      <i class="fas fa-rocket"></i>
      Quick Start
    </h3>
    
    <div class="quick-start-grid">
      <div class="quick-start-item">
        <h4>Base URL</h4>
        <div class="code-block">
          <pre><code>{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_status' %}</code></pre>
          <button class="copy-btn" onclick="copyToClipboard(this)">
            <i class="fas fa-copy"></i>
          </button>
        </div>
      </div>
      
      <div class="quick-start-item">
        <h4>Authentication</h4>
        <div class="code-block">
          <pre><code>Django Session Authentication
CSRF Token Required for POST/PUT/DELETE</code></pre>
          <button class="copy-btn" onclick="copyToClipboard(this)">
            <i class="fas fa-copy"></i>
          </button>
        </div>
      </div>
      
      <div class="quick-start-item">
        <h4>Content Type</h4>
        <div class="code-block">
          <pre><code>application/json</code></pre>
          <button class="copy-btn" onclick="copyToClipboard(this)">
            <i class="fas fa-copy"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- API Endpoints -->
  <div class="api-section">
    <h3>
      <i class="fas fa-list"></i>
      API Endpoints
    </h3>
    
    <!-- System Status Endpoint -->
    <div class="endpoint-card">
      <div class="endpoint-header">
        <div class="endpoint-title">
          <span class="method-badge get">GET</span>
          <h4>/api/status/</h4>
        </div>
        <div class="endpoint-description">
          Get system status and health information
        </div>
      </div>
      
      <div class="endpoint-details">
        <div class="endpoint-tabs">
          <button class="tab-btn active" onclick="switchEndpointTab(this, 'status-response')">Response</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'status-example')">Example</button>
        </div>
        
        <div class="tab-content active" id="status-response">
          <h5>Response Schema</h5>
          <div class="code-block">
            <pre><code>{
  "status": "healthy",
  "timestamp": "2024-01-20T10:30:00Z",
  "version": "1.0.0",
  "uptime": "2 days, 5 hours",
  "database": "connected",
  "storage": "available"
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="tab-content" id="status-example">
          <h5>cURL Example</h5>
          <div class="code-block">
            <pre><code>curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_status' %}' \
  -H 'Accept: application/json'</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Statistics Endpoint -->
    <div class="endpoint-card">
      <div class="endpoint-header">
        <div class="endpoint-title">
          <span class="method-badge get">GET</span>
          <h4>/api/statistics/</h4>
        </div>
        <div class="endpoint-description">
          Get comprehensive processing statistics and analytics
        </div>
      </div>
      
      <div class="endpoint-details">
        <div class="endpoint-tabs">
          <button class="tab-btn active" onclick="switchEndpointTab(this, 'stats-response')">Response</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'stats-example')">Example</button>
        </div>
        
        <div class="tab-content active" id="stats-response">
          <h5>Response Schema</h5>
          <div class="code-block">
            <pre><code>{
  "total_files": 125,
  "successful_files": 118,
  "failed_files": 7,
  "success_rate": 94.4,
  "total_size_processed": "2.5 GB",
  "average_processing_time": "3.2 seconds",
  "files_processed_today": 15,
  "processing_statistics": {
    "by_status": {
      "completed": 118,
      "failed": 7
    },
    "by_file_type": {
      "PDF": 89,
      "IMAGE": 36
    }
  }
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="tab-content" id="stats-example">
          <h5>cURL Example</h5>
          <div class="code-block">
            <pre><code>curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_statistics' %}' \
  -H 'Accept: application/json' \
  -H 'X-CSRFToken: {{ csrf_token }}'</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Files List Endpoint -->
    <div class="endpoint-card">
      <div class="endpoint-header">
        <div class="endpoint-title">
          <span class="method-badge get">GET</span>
          <h4>/api/files/</h4>
        </div>
        <div class="endpoint-description">
          List and filter processed files with pagination support
        </div>
      </div>
      
      <div class="endpoint-details">
        <div class="endpoint-tabs">
          <button class="tab-btn active" onclick="switchEndpointTab(this, 'files-params')">Parameters</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'files-response')">Response</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'files-example')">Example</button>
        </div>
        
        <div class="tab-content active" id="files-params">
          <h5>Query Parameters</h5>
          <div class="params-table">
            <div class="param-row">
              <div class="param-name">status</div>
              <div class="param-type">string</div>
              <div class="param-desc">Filter by processing status (completed, failed)</div>
            </div>
            <div class="param-row">
              <div class="param-name">file_type</div>
              <div class="param-type">string</div>
              <div class="param-desc">Filter by file type (pdf, image)</div>
            </div>
            <div class="param-row">
              <div class="param-name">limit</div>
              <div class="param-type">integer</div>
              <div class="param-desc">Number of results per page (default: 20)</div>
            </div>
            <div class="param-row">
              <div class="param-name">offset</div>
              <div class="param-type">integer</div>
              <div class="param-desc">Pagination offset (default: 0)</div>
            </div>
          </div>
        </div>
        
        <div class="tab-content" id="files-response">
          <h5>Response Schema</h5>
          <div class="code-block">
            <pre><code>{
  "files": [
    {
      "id": 1,
      "filename": "document.pdf",
      "original_name": "Important Document.pdf",
      "status": "completed",
      "file_type": "pdf",
      "file_size": "1.2 MB",
      "processed_date": "2024-01-20T10:30:00Z",
      "processing_time": "2.5 seconds",
      "text_extracted": true,
      "preview_url": "/api/files/preview/1/"
    }
  ],
  "pagination": {
    "total": 125,
    "limit": 20,
    "offset": 0,
    "has_next": true,
    "has_previous": false
  }
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="tab-content" id="files-example">
          <h5>cURL Example</h5>
          <div class="code-block">
            <pre><code>curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_files_list' %}?status=completed&limit=10' \
  -H 'Accept: application/json' \
  -H 'X-CSRFToken: {{ csrf_token }}'</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bulk Operations Endpoint -->
    <div class="endpoint-card">
      <div class="endpoint-header">
        <div class="endpoint-title">
          <span class="method-badge post">POST</span>
          <h4>/api/bulk-operations/</h4>
        </div>
        <div class="endpoint-description">
          Perform bulk operations on multiple files
        </div>
      </div>
      
      <div class="endpoint-details">
        <div class="endpoint-tabs">
          <button class="tab-btn active" onclick="switchEndpointTab(this, 'bulk-request')">Request</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'bulk-response')">Response</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'bulk-example')">Example</button>
        </div>
        
        <div class="tab-content active" id="bulk-request">
          <h5>Request Body</h5>
          <div class="code-block">
            <pre><code>{
  "operation": "delete",
  "file_ids": [1, 2, 3, 4],
  "options": {
    "confirm": true,
    "backup": false
  }
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
          
          <h5>Available Operations</h5>
          <div class="operations-list">
            <div class="operation-item">
              <span class="operation-name">delete</span>
              <span class="operation-desc">Remove files permanently</span>
            </div>
            <div class="operation-item">
              <span class="operation-name">reprocess</span>
              <span class="operation-desc">Re-run OCR processing</span>
            </div>
            <div class="operation-item">
              <span class="operation-name">organize</span>
              <span class="operation-desc">Move files to folders</span>
            </div>
            <div class="operation-item">
              <span class="operation-name">export</span>
              <span class="operation-desc">Create downloadable archive</span>
            </div>
          </div>
        </div>
        
        <div class="tab-content" id="bulk-response">
          <h5>Response Schema</h5>
          <div class="code-block">
            <pre><code>{
  "status": "success",
  "operation": "delete",
  "processed_files": 4,
  "failed_files": 0,
  "results": [
    {
      "file_id": 1,
      "filename": "document1.pdf",
      "status": "success",
      "message": "File deleted successfully"
    }
  ],
  "summary": {
    "total_requested": 4,
    "successful": 4,
    "failed": 0,
    "processing_time": "1.2 seconds"
  }
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="tab-content" id="bulk-example">
          <h5>cURL Example</h5>
          <div class="code-block">
            <pre><code>curl -X POST \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_bulk_operations' %}' \
  -H 'Content-Type: application/json' \
  -H 'X-CSRFToken: {{ csrf_token }}' \
  -d '{
    "operation": "reprocess",
    "file_ids": [1, 2, 3],
    "options": {"priority": "high"}
  }'</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- File Preview Endpoint -->
    <div class="endpoint-card">
      <div class="endpoint-header">
        <div class="endpoint-title">
          <span class="method-badge get">GET</span>
          <h4>/api/files/preview/{status_type}/{filename}/</h4>
        </div>
        <div class="endpoint-description">
          Get detailed file information and OCR analysis
        </div>
      </div>
      
      <div class="endpoint-details">
        <div class="endpoint-tabs">
          <button class="tab-btn active" onclick="switchEndpointTab(this, 'preview-params')">Parameters</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'preview-response')">Response</button>
          <button class="tab-btn" onclick="switchEndpointTab(this, 'preview-example')">Example</button>
        </div>
        
        <div class="tab-content active" id="preview-params">
          <h5>Path Parameters</h5>
          <div class="params-table">
            <div class="param-row">
              <div class="param-name">status_type</div>
              <div class="param-type">string</div>
              <div class="param-desc">File status directory (fully_indexed, partially_indexed, failed)</div>
            </div>
            <div class="param-row">
              <div class="param-name">filename</div>
              <div class="param-type">string</div>
              <div class="param-desc">Name of the file to preview</div>
            </div>
          </div>
        </div>
        
        <div class="tab-content" id="preview-response">
          <h5>Response Schema</h5>
          <div class="code-block">
            <pre><code>{
  "file_info": {
    "filename": "document.pdf",
    "original_name": "Important Document.pdf",
    "file_size": "1.2 MB",
    "file_type": "PDF",
    "status": "fully_indexed",
    "created_date": "2024-01-20T10:30:00Z"
  },
  "ocr_analysis": {
    "text_extracted": true,
    "confidence_score": 95.2,
    "language_detected": "English",
    "page_count": 3,
    "word_count": 847,
    "processing_time": "2.5 seconds"
  },
  "processing_history": [
    {
      "timestamp": "2024-01-20T10:30:00Z",
      "action": "uploaded",
      "status": "success"
    },
    {
      "timestamp": "2024-01-20T10:30:15Z",
      "action": "ocr_processing",
      "status": "completed"
    }
  ],
  "file_url": "/media/fully_indexed/document.pdf",
  "preview_available": true
}</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
        
        <div class="tab-content" id="preview-example">
          <h5>cURL Example</h5>
          <div class="code-block">
            <pre><code>curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}/api/files/preview/fully_indexed/document.pdf/' \
  -H 'Accept: application/json' \
  -H 'X-CSRFToken: {{ csrf_token }}'</code></pre>
            <button class="copy-btn" onclick="copyToClipboard(this)">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SDK Examples -->
  <div class="api-section">
    <h3>
      <i class="fas fa-code-branch"></i>
      SDK Examples
    </h3>
    
    <div class="sdk-tabs">
      <button class="sdk-tab active" onclick="switchSDKTab('javascript')">JavaScript</button>
      <button class="sdk-tab" onclick="switchSDKTab('python')">Python</button>
      <button class="sdk-tab" onclick="switchSDKTab('curl')">cURL</button>
    </div>
    
    <div class="sdk-content active" id="javascript-sdk">
      <h4>JavaScript / Node.js</h4>
      <div class="code-block">
        <pre><code>// File Manager API Client
class FileManagerAPI {
  constructor(baseURL, csrfToken) {
    this.baseURL = baseURL;
    this.csrfToken = csrfToken;
  }

  async getStatus() {
    const response = await fetch(`${this.baseURL}/api/status/`);
    return response.json();
  }

  async getFiles(filters = {}) {
    const params = new URLSearchParams(filters);
    const response = await fetch(`${this.baseURL}/api/files/?${params}`);
    return response.json();
  }

  async bulkOperation(operation, fileIds, options = {}) {
    const response = await fetch(`${this.baseURL}/api/bulk-operations/`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': this.csrfToken
      },
      body: JSON.stringify({
        operation,
        file_ids: fileIds,
        options
      })
    });
    return response.json();
  }
}

// Usage
const api = new FileManagerAPI('{{ request.build_absolute_uri|slice:":-1" }}', '{{ csrf_token }}');
const status = await api.getStatus();
console.log('System status:', status);</code></pre>
        <button class="copy-btn" onclick="copyToClipboard(this)">
          <i class="fas fa-copy"></i>
        </button>
      </div>
    </div>
    
    <div class="sdk-content" id="python-sdk">
      <h4>Python</h4>
      <div class="code-block">
        <pre><code>import requests
import json

class FileManagerAPI:
    def __init__(self, base_url, csrf_token):
        self.base_url = base_url
        self.csrf_token = csrf_token
        self.session = requests.Session()
        self.session.headers.update({
            'X-CSRFToken': csrf_token,
            'Content-Type': 'application/json'
        })
    
    def get_status(self):
        response = self.session.get(f"{self.base_url}/api/status/")
        return response.json()
    
    def get_files(self, **filters):
        response = self.session.get(f"{self.base_url}/api/files/", params=filters)
        return response.json()
    
    def bulk_operation(self, operation, file_ids, options=None):
        data = {
            'operation': operation,
            'file_ids': file_ids,
            'options': options or {}
        }
        response = self.session.post(f"{self.base_url}/api/bulk-operations/", json=data)
        return response.json()

# Usage
api = FileManagerAPI('{{ request.build_absolute_uri|slice:":-1" }}', '{{ csrf_token }}')
status = api.get_status()
print(f"System status: {status['status']}")

# Get completed files
files = api.get_files(status='completed', limit=10)
print(f"Found {files['pagination']['total']} files")</code></pre>
        <button class="copy-btn" onclick="copyToClipboard(this)">
          <i class="fas fa-copy"></i>
        </button>
      </div>
    </div>
    
    <div class="sdk-content" id="curl-sdk">
      <h4>cURL Examples</h4>
      <div class="code-block">
        <pre><code># Get system status
curl -X GET '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_status' %}'

# Get processing statistics
curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_statistics' %}' \
  -H 'X-CSRFToken: {{ csrf_token }}'

# List files with filters
curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_files_list' %}?status=completed&limit=5' \
  -H 'X-CSRFToken: {{ csrf_token }}'

# Bulk delete operation
curl -X POST \
  '{{ request.build_absolute_uri|slice:":-1" }}{% url 'ocr:api_bulk_operations' %}' \
  -H 'Content-Type: application/json' \
  -H 'X-CSRFToken: {{ csrf_token }}' \
  -d '{
    "operation": "delete",
    "file_ids": [1, 2, 3],
    "options": {"confirm": true}
  }'

# Get file preview
curl -X GET \
  '{{ request.build_absolute_uri|slice:":-1" }}/api/files/preview/fully_indexed/document.pdf/' \
  -H 'X-CSRFToken: {{ csrf_token }}'</code></pre>
        <button class="copy-btn" onclick="copyToClipboard(this)">
          <i class="fas fa-copy"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Error Responses -->
  <div class="api-section">
    <h3>
      <i class="fas fa-exclamation-triangle"></i>
      Error Responses
    </h3>
    
    <div class="error-examples">
      <div class="error-card">
        <h4>400 Bad Request</h4>
        <div class="code-block">
          <pre><code>{
  "error": "Bad Request",
  "message": "Invalid operation specified",
  "details": {
    "operation": ["This field is required"]
  }
}</code></pre>
        </div>
      </div>
      
      <div class="error-card">
        <h4>401 Unauthorized</h4>
        <div class="code-block">
          <pre><code>{
  "error": "Unauthorized",
  "message": "Authentication required"
}</code></pre>
        </div>
      </div>
      
      <div class="error-card">
        <h4>404 Not Found</h4>
        <div class="code-block">
          <pre><code>{
  "error": "Not Found",
  "message": "File not found",
  "details": {
    "filename": "document.pdf",
    "status_type": "fully_indexed"
  }
}</code></pre>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.api-docs-container {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

/* API Overview */
.api-overview {
  background: rgba(51, 65, 85, 0.9);
  backdrop-filter: blur(25px);
  border: 1px solid rgba(148, 163, 184, 0.2);
  border-radius: 20px;
  padding: 30px;
  margin-bottom: 30px;
}

.overview-header h2 {
  color: white;
  font-size: 28px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.overview-header p {
  color: rgba(255, 255, 255, 0.7);
  font-size: 16px;
  margin-bottom: 30px;
}

.api-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.stat-card {
  background: rgba(15, 23, 42, 0.4);
  border: 1px solid rgba(148, 163, 184, 0.1);
  border-radius: 12px;
  padding: 20px;
  display: flex;
  align-items: center;
  gap: 15px;
}

.stat-icon {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #3b82f6, #8b5cf6);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  color: white;
}

.stat-info {
  display: flex;
  flex-direction: column;
}

.stat-number {
  color: white;
  font-size: 24px;
  font-weight: 700;
  line-height: 1;
}

.stat-label {
  color: rgba(255, 255, 255, 0.7);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* API Section */
.api-section {
  background: rgba(51, 65, 85, 0.9);
  backdrop-filter: blur(25px);
  border: 1px solid rgba(148, 163, 184, 0.2);
  border-radius: 20px;
  padding: 30px;
  margin-bottom: 30px;
}

.api-section h3 {
  color: white;
  font-size: 24px;
  margin-bottom: 25px;
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Quick Start Grid */
.quick-start-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
}

.quick-start-item h4 {
  color: rgba(255, 255, 255, 0.9);
  font-size: 16px;
  margin-bottom: 12px;
}

/* Endpoint Cards */
.endpoint-card {
  background: rgba(15, 23, 42, 0.4);
  border: 1px solid rgba(148, 163, 184, 0.1);
  border-radius: 12px;
  margin-bottom: 25px;
  overflow: hidden;
}

.endpoint-header {
  padding: 20px;
  border-bottom: 1px solid rgba(148, 163, 184, 0.1);
}

.endpoint-title {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 8px;
}

.endpoint-title h4 {
  color: white;
  font-size: 18px;
  margin: 0;
  font-family: 'Courier New', monospace;
}

.method-badge {
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.method-badge.get {
  background: rgba(34, 197, 94, 0.2);
  color: #22c55e;
  border: 1px solid rgba(34, 197, 94, 0.3);
}

.method-badge.post {
  background: rgba(59, 130, 246, 0.2);
  color: #3b82f6;
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.endpoint-description {
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
}

.endpoint-details {
  padding: 20px;
}

/* Tabs */
.endpoint-tabs, .sdk-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
  border-bottom: 1px solid rgba(148, 163, 184, 0.1);
  padding-bottom: 10px;
}

.tab-btn, .sdk-tab {
  padding: 8px 16px;
  background: transparent;
  border: 1px solid rgba(148, 163, 184, 0.2);
  border-radius: 6px;
  color: rgba(255, 255, 255, 0.7);
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 14px;
}

.tab-btn:hover, .sdk-tab:hover {
  background: rgba(255, 255, 255, 0.05);
  color: rgba(255, 255, 255, 0.9);
}

.tab-btn.active, .sdk-tab.active {
  background: rgba(59, 130, 246, 0.2);
  border-color: #3b82f6;
  color: #3b82f6;
}

.tab-content, .sdk-content {
  display: none;
}

.tab-content.active, .sdk-content.active {
  display: block;
}

.tab-content h5 {
  color: white;
  font-size: 16px;
  margin-bottom: 15px;
}

/* Code Blocks */
.code-block {
  position: relative;
  background: rgba(15, 23, 42, 0.8);
  border: 1px solid rgba(148, 163, 184, 0.2);
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 20px;
}

.code-block pre {
  margin: 0;
  padding: 20px;
  color: #e2e8f0;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.5;
  overflow-x: auto;
}

.copy-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  background: rgba(59, 130, 246, 0.2);
  border: 1px solid rgba(59, 130, 246, 0.3);
  border-radius: 6px;
  color: #3b82f6;
  padding: 6px 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 12px;
}

.copy-btn:hover {
  background: rgba(59, 130, 246, 0.3);
}

/* Parameters Table */
.params-table {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.param-row {
  display: grid;
  grid-template-columns: 1fr 1fr 2fr;
  gap: 15px;
  padding: 12px;
  background: rgba(15, 23, 42, 0.4);
  border-radius: 8px;
  align-items: center;
}

.param-name {
  color: #3b82f6;
  font-family: 'Courier New', monospace;
  font-weight: 600;
}

.param-type {
  color: #22c55e;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  text-transform: uppercase;
}

.param-desc {
  color: rgba(255, 255, 255, 0.8);
  font-size: 14px;
}

/* Operations List */
.operations-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 15px;
}

.operation-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: rgba(15, 23, 42, 0.4);
  border-radius: 6px;
}

.operation-name {
  color: #8b5cf6;
  font-family: 'Courier New', monospace;
  font-weight: 600;
}

.operation-desc {
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
}

/* Error Examples */
.error-examples {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
}

.error-card {
  background: rgba(15, 23, 42, 0.4);
  border: 1px solid rgba(239, 68, 68, 0.2);
  border-radius: 12px;
  padding: 20px;
}

.error-card h4 {
  color: #ef4444;
  font-size: 16px;
  margin-bottom: 15px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .api-docs-container {
    padding: 15px;
  }
  
  .overview-header h2 {
    font-size: 24px;
  }
  
  .api-stats {
    grid-template-columns: 1fr;
  }
  
  .quick-start-grid {
    grid-template-columns: 1fr;
  }
  
  .param-row {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .error-examples {
    grid-template-columns: 1fr;
  }
  
  .endpoint-tabs, .sdk-tabs {
    flex-wrap: wrap;
  }
}
</style>

<script>
// Tab switching for endpoints
function switchEndpointTab(button, targetId) {
  const container = button.closest('.endpoint-details');
  
  // Remove active class from all tabs and content in this container
  container.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  container.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
  
  // Add active class to clicked button and target content
  button.classList.add('active');
  document.getElementById(targetId).classList.add('active');
}

// Tab switching for SDK examples
function switchSDKTab(tabName) {
  // Remove active class from all SDK tabs and content
  document.querySelectorAll('.sdk-tab').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.sdk-content').forEach(content => content.classList.remove('active'));
  
  // Add active class to selected tab and content
  event.target.classList.add('active');
  document.getElementById(tabName + '-sdk').classList.add('active');
}

// Copy to clipboard functionality
function copyToClipboard(button) {
  const codeBlock = button.parentElement;
  const pre = codeBlock.querySelector('pre');
  const code = pre.textContent;
  
  navigator.clipboard.writeText(code).then(() => {
    // Show success feedback
    const originalIcon = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check"></i>';
    button.style.color = '#22c55e';
    
    setTimeout(() => {
      button.innerHTML = originalIcon;
      button.style.color = '';
    }, 2000);
  }).catch(() => {
    // Fallback for older browsers
    const textArea = document.createElement('textarea');
    textArea.value = code;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    
    // Show success feedback
    const originalIcon = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check"></i>';
    button.style.color = '#22c55e';
    
    setTimeout(() => {
      button.innerHTML = originalIcon;
      button.style.color = '';
    }, 2000);
  });
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
  // Show first tab content for each endpoint by default
  document.querySelectorAll('.endpoint-card').forEach(card => {
    const firstTab = card.querySelector('.tab-btn');
    const firstContent = card.querySelector('.tab-content');
    if (firstTab && firstContent) {
      firstTab.classList.add('active');
      firstContent.classList.add('active');
    }
  });
});
</script>
{% endblock %}
